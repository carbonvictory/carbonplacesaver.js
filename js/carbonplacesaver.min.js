(function(c,a,d){c.fn.carbonPlacesaver=function(e){var f=c.extend({},c.fn.carbonPlacesaver.defaultSettings,e||{});var g=new b(f);g.resumeReading();return this.bind("scroll",function(){g.savePlace();if(g.isDoneReading()){g.endReading();}});};c.fn.carbonPlacesaver.defaultSettings={uniquePageKey:window.location.pathname.replace(/[^\w]/g,""),sensitivity:100,scrollSpeed:"slow",duration:2,clearOnFinish:true,clearElement:"footer"};function b(e){this.placesaver=null;this.settings=e;this.currentScrollPosition=null;return this;}b.prototype={resumeReading:function(){var e=c.cookie(this.settings.uniquePageKey);if(e!=null){c("html, body").animate({scrollTop:e},this.settings.scrollSpeed);this.currentScrollPosition=e;}else{this.currentScrollPosition=0;}},savePlace:function(){var e=c(window).scrollTop();if(e-this.currentScrollPosition>=this.settings.sensitivity){c.cookie(this.settings.uniquePageKey,e,{expires:this.settings.duration});}},isDoneReading:function(){if(this.settings.clearOnFinish==true){var h=c(window).scrollTop();var e=h+c(window).height();var f=c(this.settings.clearElement).offset().top;var g=f+c(this.settings.clearElement).height();return((g>=h)&&(f<=e)&&(g<=e)&&(f>=h));}else{return false;}},endReading:function(){c.cookie(this.settings.uniquePageKey,null);}};})(jQuery);